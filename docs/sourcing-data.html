<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>4 Sourcing data | POLS0008: Introduction to Quantitative Research Methods</title>
  <meta name="description" content="4 Sourcing data | POLS0008: Introduction to Quantitative Research Methods." />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="4 Sourcing data | POLS0008: Introduction to Quantitative Research Methods" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://jtvandijk.github.io/POLS0008_20202021/" />
  
  <meta property="og:description" content="4 Sourcing data | POLS0008: Introduction to Quantitative Research Methods." />
  <meta name="github-repo" content="jtvandijk/POLS0008" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="4 Sourcing data | POLS0008: Introduction to Quantitative Research Methods" />
  
  <meta name="twitter:description" content="4 Sourcing data | POLS0008: Introduction to Quantitative Research Methods." />
  

<meta name="author" content="Justin van Dijk, Stephen Jivraj" />


<meta name="date" content="2021-08-03" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="examining-data-ii.html"/>

<script src="libs/header-attrs-2.5/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0/anchor-sections.js"></script>
<link href="libs/vembedr-0.1.4/css/vembedr.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="assets/custom.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="toc-logo">
<a href="https://www.ucl.ac.uk/module-catalogue/modules/introduction-to-quantitative-research-methods-POLS0008"><img src="images/general/ucl_logo.png">
</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#course-introduction"><i class="fa fa-check"></i>Course Introduction</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#moodle"><i class="fa fa-check"></i>Moodle</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#structure"><i class="fa fa-check"></i>Structure</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#assessment"><i class="fa fa-check"></i>Assessment</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#technical-support"><i class="fa fa-check"></i>Technical support</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#office-hours"><i class="fa fa-check"></i>Office hours</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="understanding-data.html"><a href="understanding-data.html"><i class="fa fa-check"></i><b>1</b> Understanding data</a>
<ul>
<li class="chapter" data-level="1.1" data-path="understanding-data.html"><a href="understanding-data.html#introduction-w01"><i class="fa fa-check"></i><b>1.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="understanding-data.html"><a href="understanding-data.html#reading-list-w01"><i class="fa fa-check"></i><b>1.1.1</b> Reading list</a></li>
<li class="chapter" data-level="1.1.2" data-path="understanding-data.html"><a href="understanding-data.html#qa-session"><i class="fa fa-check"></i><b>1.1.2</b> Q&amp;A session</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="understanding-data.html"><a href="understanding-data.html#data-and-statistics"><i class="fa fa-check"></i><b>1.2</b> Data and statistics</a></li>
<li class="chapter" data-level="1.3" data-path="understanding-data.html"><a href="understanding-data.html#r-for-data-analysis"><i class="fa fa-check"></i><b>1.3</b> R for data analysis</a></li>
<li class="chapter" data-level="1.4" data-path="understanding-data.html"><a href="understanding-data.html#r-console"><i class="fa fa-check"></i><b>1.4</b> R console</a></li>
<li class="chapter" data-level="1.5" data-path="understanding-data.html"><a href="understanding-data.html#r-script"><i class="fa fa-check"></i><b>1.5</b> R script</a></li>
<li class="chapter" data-level="1.6" data-path="understanding-data.html"><a href="understanding-data.html#seminar-w01"><i class="fa fa-check"></i><b>1.6</b> Seminar</a></li>
<li class="chapter" data-level="1.7" data-path="understanding-data.html"><a href="understanding-data.html#byl-w01"><i class="fa fa-check"></i><b>1.7</b> Before you leave</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="examining-data-i.html"><a href="examining-data-i.html"><i class="fa fa-check"></i><b>2</b> Examining data I</a>
<ul>
<li class="chapter" data-level="2.1" data-path="examining-data-i.html"><a href="examining-data-i.html#introduction-w02"><i class="fa fa-check"></i><b>2.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="examining-data-i.html"><a href="examining-data-i.html#reading-list-w02"><i class="fa fa-check"></i><b>2.1.1</b> Reading list</a></li>
<li class="chapter" data-level="2.1.2" data-path="understanding-data.html"><a href="understanding-data.html#qa-session"><i class="fa fa-check"></i><b>2.1.2</b> Q&amp;A session</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="examining-data-i.html"><a href="examining-data-i.html#measures-of-central-tendency"><i class="fa fa-check"></i><b>2.2</b> Measures of central tendency</a></li>
<li class="chapter" data-level="2.3" data-path="examining-data-i.html"><a href="examining-data-i.html#simple-plots"><i class="fa fa-check"></i><b>2.3</b> Simple plots</a></li>
<li class="chapter" data-level="2.4" data-path="examining-data-i.html"><a href="examining-data-i.html#measures-of-dispersion"><i class="fa fa-check"></i><b>2.4</b> Measures of dispersion</a></li>
<li class="chapter" data-level="2.5" data-path="examining-data-i.html"><a href="examining-data-i.html#seminar-w02"><i class="fa fa-check"></i><b>2.5</b> Seminar</a></li>
<li class="chapter" data-level="2.6" data-path="examining-data-i.html"><a href="examining-data-i.html#byl-w02"><i class="fa fa-check"></i><b>2.6</b> Before you leave</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="examining-data-ii.html"><a href="examining-data-ii.html"><i class="fa fa-check"></i><b>3</b> Examining data II</a>
<ul>
<li class="chapter" data-level="3.1" data-path="examining-data-ii.html"><a href="examining-data-ii.html#introduction-w03"><i class="fa fa-check"></i><b>3.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="examining-data-ii.html"><a href="examining-data-ii.html#reading-list-w03"><i class="fa fa-check"></i><b>3.1.1</b> Reading list</a></li>
<li class="chapter" data-level="3.1.2" data-path="understanding-data.html"><a href="understanding-data.html#qa-session"><i class="fa fa-check"></i><b>3.1.2</b> Q&amp;A session</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="examining-data-ii.html"><a href="examining-data-ii.html#data-visualisation"><i class="fa fa-check"></i><b>3.2</b> Data visualisation</a></li>
<li class="chapter" data-level="3.3" data-path="examining-data-ii.html"><a href="examining-data-ii.html#ggplot2"><i class="fa fa-check"></i><b>3.3</b> ggplot2</a></li>
<li class="chapter" data-level="3.4" data-path="examining-data-ii.html"><a href="examining-data-ii.html#seminar-w03"><i class="fa fa-check"></i><b>3.4</b> Seminar</a></li>
<li class="chapter" data-level="3.5" data-path="examining-data-ii.html"><a href="examining-data-ii.html#byl-w03"><i class="fa fa-check"></i><b>3.5</b> Before you leave</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="sourcing-data.html"><a href="sourcing-data.html"><i class="fa fa-check"></i><b>4</b> Sourcing data</a>
<ul>
<li class="chapter" data-level="4.1" data-path="sourcing-data.html"><a href="sourcing-data.html#introduction-w04"><i class="fa fa-check"></i><b>4.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="sourcing-data.html"><a href="sourcing-data.html#reading-list-w04"><i class="fa fa-check"></i><b>4.1.1</b> Reading list</a></li>
<li class="chapter" data-level="4.1.2" data-path="understanding-data.html"><a href="understanding-data.html#qa-session"><i class="fa fa-check"></i><b>4.1.2</b> Q&amp;A session</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="sourcing-data.html"><a href="sourcing-data.html#sourcing-data-1"><i class="fa fa-check"></i><b>4.2</b> Sourcing data</a></li>
<li class="chapter" data-level="4.3" data-path="sourcing-data.html"><a href="sourcing-data.html#preparing-data"><i class="fa fa-check"></i><b>4.3</b> Preparing data</a></li>
<li class="chapter" data-level="4.4" data-path="sourcing-data.html"><a href="sourcing-data.html#seminar-w04"><i class="fa fa-check"></i><b>4.4</b> Seminar</a></li>
<li class="chapter" data-level="4.5" data-path="sourcing-data.html"><a href="sourcing-data.html#byl-w04"><i class="fa fa-check"></i><b>4.5</b> Before you leave</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">POLS0008: Introduction to Quantitative Research Methods</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="sourcing-data" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Sourcing data</h1>
<div id="introduction-w04" class="section level2" number="4.1">
<h2><span class="header-section-number">4.1</span> Introduction</h2>
<p>Welcome to your fourth week of <strong>Introduction to Quantitative Research Methods</strong>. This week we will introduce you to sourcing and preparing data from official sources. For the tutorial we will apply what we have learnt over the past weeks onto a new data set.</p>
<p>This week is structured by <strong>4</strong> short videos, practical material that you need to work through in preparation for Thursday’s seminar, and a seminar task that you need to do in preparation for Thursday’s seminar.</p>
<p>Let’s do it.</p>
<div id="video-introduction-w4" class="section level4 unnumbered">
<h4>Video: Introduction W4</h4>
<p><div class="vembedr" align="left">
<div>
<iframe src="https://web.microsoftstream.com/embed/video/bc8a46a4-c664-470d-b85f-118d4449bc63?autoplay=false&amp;showinfo=true" width="533" height="300" style="border:none;"></iframe>
</div>
</div>
[Lecture slides] <a href="https://web.microsoftstream.com/video/bc8a46a4-c664-470d-b85f-118d4449bc63">[Watch on MS stream]</a></p>
</div>
<div id="reading-list-w04" class="section level3" number="4.1.1">
<h3><span class="header-section-number">4.1.1</span> Reading list</h3>
<p>Please find the reading list for this week below. We strongly recommend that you read the <strong>core reading material</strong> before you continue with the rest of this week’s material.</p>
<div id="core-reading" class="section level4 unnumbered">
<h4>Core reading</h4>
<ul>
<li>Wickham, 2014, Tidy data, <em>Journal of Statistical Software</em> 59(10). <a href="http://www.jstatsoft.org/v59/i10/paper">[Link]</a></li>
</ul>
</div>
<div id="supplementary-reading" class="section level4 unnumbered">
<h4>Supplementary reading</h4>
<ul>
<li>Zhang <em>et al.</em>, 2010, Data preparation for data mining. <em>Applied Artificial Intelligence</em> 17(5-6): 375-381. <a href="https://doi.org/10.1080/713827180">[Link]</a></li>
</ul>
</div>
</div>
<div id="qa-session" class="section level3" number="4.1.2">
<h3><span class="header-section-number">4.1.2</span> Q&amp;A session</h3>
<p>This week there is <strong>NO</strong> live Q&amp;A session scheduled. Please post any questions you have on the <a href="https://moodle.ucl.ac.uk/mod/forum/view.php?id=1632137">POLS0008 Forum</a> or ask them to your seminar leader during your live seminar on Thursday.</p>
</div>
</div>
<div id="sourcing-data-1" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Sourcing data</h2>
<p>Over the past weeks we have predominantly worked with two data sets that we provided for you: <code>ambulance-assault.csv</code> and <code>census-historic-population-borough.csv</code>. Although these data sets are very useful to give you an introduction to Quantitative Research methods, in real life data you will have to source your own data. In the case of the social sciences, you often can find socio-economic data on the websites of national statistical authorities such as the <a href="https://www.ons.gov.uk/">Office for National Statistics</a>, <a href="https://www.census.gov/">United States Census Bureau</a>, <a href="http://www.statssa.gov.za/">Statistics South Africa</a>, or the <a href="http://www.stats.gov.cn/english/">National Bureau of Statistics of China</a>. Also large international institutions like <a href="https://www.worldbank.org/">World Bank</a> and <a href="https://www.unicef.org/">Unicef</a> compile socio-economic data sets and make these available for research purposes. No matter where you will be getting your data from, however, you will have to know how to download and prepare these data sets in such a way that you can work with them in R to conduct your analysis.</p>
<div id="video-sourcing-data-i" class="section level4 unnumbered">
<h4>Video: Sourcing data I</h4>
<p><div class="vembedr" align="left">
<div>
<iframe src="https://web.microsoftstream.com/embed/video/53e1631e-8b44-4e4e-894c-2c3c801dc880?autoplay=false&amp;showinfo=true" width="533" height="300" style="border:none;"></iframe>
</div>
</div>
<a href="https://liveuclac-my.sharepoint.com/:b:/g/personal/ucfajtv_ucl_ac_uk/EW8A8akMbrpFtL4TOIhpLMcBdhUWzPJeB6cCYvjMtqlcZg?e=lBOjLz">[Lecture slides]</a> <a href="https://web.microsoftstream.com/video/53e1631e-8b44-4e4e-894c-2c3c801dc880">[Watch on MS stream]</a></p>
<p>Within the United Kingdom, the <a href="https://www.ons.gov.uk/">Office for National Statistics</a> (ONS) is the largest producer of official statistics. ONS is responsible for collecting and publishing statistics related to the economy, population and society at national, regional and local levels. They are also responsible for conducting the census in England and Wales every 10 years (the census for Scotland and Northern Ireland are conducted by the <a href="https://www.nrscotland.gov.uk/">National Records of Scotland</a> and the <a href="https://www.nisra.gov.uk/">Northern Ireland Statistics and Research Agency</a>, respectively). Today we will be downloading a data set from ONS, prepare the data set as a <code>csv</code> file, and read our freshly created <code>csv</code> file into R.</p>
<div class="figure" style="text-align: center"><span id="fig:04-ons-website"></span>
<img src="images/week04/04_ons_web.png" alt="The website of the Office for National Statistics."  />
<p class="caption">
Figure 4.1: The website of the Office for National Statistics.
</p>
</div>
<p>Because the population data in the <code>census-historic-population-borough.csv</code> we have been working with so far only goes as far as 2011, we will try to get some more recent population estimates on the ‘usual resident population’. Every year, ONS releases a new set of Middle Super Output Area <a href="https://www.ons.gov.uk/peoplepopulationandcommunity/populationandmigration/populationestimates/datasets/middlesuperoutputareamidyearpopulationestimates">mid-year population estimates</a>. Currently, the latest available data set is that of mid-2019 and this is the data set that we are now going to download and prepare.</p>
<div class="note">
<p><strong>Note</strong><br/>
The mid-year population estimates that we will be downloading are provided by ONS at the <a href="https://www.ons.gov.uk/methodology/geography/ukgeographies/censusgeography">Middle Super Output Area</a> (MSOA) level. MSOAs are one of the many administrative geographies that the ONS uses for reporting their small area statistics. An administrative geography is a way of dividing the country into smaller sub-divisions or areas that correspond with the area of responsibility of local authorities and government bodies. These geographies are updated as populations evolve and as a result, the boundaries of the administrative geographies are subject to either periodic or occasional change. The UK has quite a complex administrative geography, particularly due to having several countries within one overriding administration and then multiple ways of dividing the countries according to specific applications.</p>
</div>
<p>To download the data set, you need to take the following steps:</p>
<table>
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">Step</th>
<th align="left">Action</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">1</td>
<td align="left">Navigate to the download page of the Middle Super Output Area population estimates: <a href="https://www.ons.gov.uk/peoplepopulationandcommunity/populationandmigration/populationestimates/datasets/middlesuperoutputareamidyearpopulationestimates">[Link]</a></td>
</tr>
<tr class="even">
<td align="center">2</td>
<td align="left">Download the file <code>Mid-2019: SAPE22DT14</code> to your computer.</td>
</tr>
<tr class="odd">
<td align="center">3</td>
<td align="left">Because the file that you have now downloaded is a <code>zip</code> file, we first <strong>need</strong> to extract the file before we can use it. To unzip the file you can use the built-in functionality of your computer’s operating system. For <a href="https://support.microsoft.com/en-us/windows/zip-and-unzip-files-f6dde0a7-0fec-8294-e1d3-703ed85e7ebc#:~:text=To%20unzip%20files,folder%20to%20a%20new%20location.">Windows</a>: right click on the <code>zip</code> file, select <em>Extract All</em>, and then follow the instructions. For <a href="https://www.howtogeek.com/672240/how-to-zip-and-unzip-files-and-folders-on-mac/">Mac OS</a>: double-click the <code>zip</code> file.</td>
</tr>
<tr class="even">
<td align="center">4</td>
<td align="left">Open the file in Microsoft Excel or any other spreadsheet software. Please note that the instructions provided below use only cover Microsoft Excel.</td>
</tr>
<tr class="odd">
<td align="center">5</td>
<td align="left">Once opened your file should look similar as the screenshot in Figure <a href="sourcing-data.html#fig:04-mid-year-download">4.2</a>.</td>
</tr>
</tbody>
</table>
<div class="figure" style="text-align: center"><span id="fig:04-mid-year-download"></span>
<img src="images/week04/04_download.png" alt="The `Mid-2019: SAPE22DT15` file that we downloaded."  />
<p class="caption">
Figure 4.2: The <code>Mid-2019: SAPE22DT15</code> file that we downloaded.
</p>
</div>
<p>The file probably does not look exactly like you thought it would because we do not directly see any data! In fact, ONS has put the data on different tabs. Some of these tabs contain the actual data, whilst others contain some <a href="https://en.wikipedia.org/wiki/Metadata">meta-data</a> and notes and definitions. The data that we want to use is found on the <code>Mid-2019 Persons</code> tab: the total number of people living in each MSOA. The problem we have now, however, is that the data as it is right now cannot be read into R without causing us lots of problems down the road. So even though we have the data we want to work with at our finger tips, we are not yet ready to read our data set into R! So, in video below, we will show you how to create a <code>csv</code> from the data that we want to use.</p>
</div>
<div id="video-sourcing-data-ii" class="section level4 unnumbered">
<h4>Video: Sourcing data II</h4>
<p><div class="vembedr" align="left">
<div>
<iframe src="https://web.microsoftstream.com/embed/video/c0c8aad3-f624-44fd-ac70-42841dc4ae63?autoplay=false&amp;showinfo=true" width="533" height="300" style="border:none;"></iframe>
</div>
</div>
[Lecture slides] <a href="https://web.microsoftstream.com/video/c0c8aad3-f624-44fd-ac70-42841dc4ae63">[Watch on MS stream]</a></p>
<p>Now you have seen how to prepare your <code>csv</code>, it is time to do it yourselves. Just as a small recap, these are the steps that you need to take to turn the downloaded data into a <code>csv</code>:</p>
<table>
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">Step</th>
<th align="left">Action</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">1</td>
<td align="left">Open the downloaded file in Microsoft Excel and activate the <code>Mid-2019 Persons</code> tab.</td>
</tr>
<tr class="even">
<td align="center">2</td>
<td align="left">Highlight the columns: <em>MSOA Code</em>, <em>MSOA Name</em>, <em>LA Code (2019 boundaries)</em>, <em>LA name (2019 boundaries)</em>, <em>LA Code (2020 boundaries)</em>, <em>LA name (2020 boundaries)</em>, and <em>All Ages</em>. Do make sure that you do not include any of the whitespace or empty rows.</td>
</tr>
<tr class="odd">
<td align="center">3</td>
<td align="left">Scroll down all the way to the bottom of the file. Now hold down the <strong>shift</strong> button and click on the last value in the <em>All Ages</em> column. This value should be 9,711. All data should now be selected.</td>
</tr>
<tr class="even">
<td align="center">4</td>
<td align="left">Now all the data that we need are selected we can copy them by right clicking and in the context menu opting for the <strong>copy</strong> option. Of course, you can also simply use <code>control</code> + <code>c</code> (Windows) or <code>command</code> + <code>c</code> (Mac OS).</td>
</tr>
<tr class="odd">
<td align="center">5</td>
<td align="left">Open a new, empty spreadsheet and paste the copied data into this new, empty spreadsheet. You can paste your copied data by right clicking on the first cell (<em>A1</em>) and in the context menu opting for the <strong>paste</strong> option. Of course, you can also simply use <code>control</code> + <code>v</code> (Windows) or <code>command</code> + <code>v</code> (Mac OS).</td>
</tr>
<tr class="even">
<td align="center">6</td>
<td align="left">Conduct a visual check to make sure that you copied all the data.</td>
</tr>
<tr class="odd">
<td align="center">7</td>
<td align="left">Conduct a visual check to make sure that you did not copy any additional data.</td>
</tr>
<tr class="even">
<td align="center">8</td>
<td align="left">Remove all formatting and make sure that empty columns are indeed empty.</td>
</tr>
<tr class="odd">
<td align="center">9</td>
<td align="left">Save this file as a <code>midyear2019.csv</code>. Make sure that you select <code>csv</code> as your file format (e.g. <code>CSV UTF8 (Comma-delimited) (.csv)</code>).</td>
</tr>
<tr class="even">
<td align="center">10</td>
<td align="left">Inspect your data in a text editor such as <a href="https://en.wikipedia.org/wiki/WordPad">Wordpad</a> or <a href="https://support.apple.com/en-gb/guide/textedit/welcome/mac">Textedit</a> to make sure the file you created is indeed a comma-separated file.</td>
</tr>
</tbody>
</table>
<p>Now, for the moment of truth: let’s try and see if we can load our data into R! Of course, you will first need to upload your <code>csv</code> file to RStudio Server and set your working directory so that R can find the file - but you should be able to do that without any problems by now.</p>
<div class="sourceCode" id="cb178"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb178-1"><a href="sourcing-data.html#cb178-1" aria-hidden="true"></a><span class="co"># load csv file from working directory</span></span>
<span id="cb178-2"><a href="sourcing-data.html#cb178-2" aria-hidden="true"></a>midyear &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&#39;midyear2019.csv&#39;</span>)</span></code></pre></div>
<pre><code>##   MSOA.Code      MSOA.Name LA.Code..2019.boundaries.
## 1 E02002483 Hartlepool 001                 E06000001
## 2 E02002484 Hartlepool 002                 E06000001
## 3 E02002485 Hartlepool 003                 E06000001
## 4 E02002487 Hartlepool 005                 E06000001
##   LA.name..2019.boundaries. LA.Code..2020.boundaries.
## 1                Hartlepool                 E06000001
## 2                Hartlepool                 E06000001
## 3                Hartlepool                 E06000001
## 4                Hartlepool                 E06000001
##   LA.name..2020.boundaries. All.Ages
## 1                Hartlepool   10 261
## 2                Hartlepool   10 449
## 3                Hartlepool    8 185
## 4                Hartlepool    5 277
##  [ reached &#39;max&#39; / getOption(&quot;max.print&quot;) -- omitted 7197 rows ]</code></pre>
</div>
<div id="questions" class="section level4 unnumbered">
<h4>Questions</h4>
<ol style="list-style-type: decimal">
<li>Inspect the column names. Why do you think that they slightly differ from the ones that we saw in Microsoft Excel?</li>
<li>How many rows does the <code>midyear</code> dataframe have?</li>
<li>How many columns does the <code>midyear</code> dataframe have?</li>
</ol>
<p>The column names may seem a little complicated but in fact simply refer to some of the administrative geographies that the ONS uses for their statistics. Don’t worry if you do not fully understand these as they are <a href="https://en.wikipedia.org/wiki/Administrative_geography_of_the_United_Kingdom">notoriously complicated and confusing</a>!</p>
<table>
<colgroup>
<col width="21%" />
<col width="21%" />
<col width="57%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Column heading</th>
<th align="left">Full name</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><strong>MSOA.Code</strong></td>
<td align="left">MSOA Code</td>
<td align="left"><a href="https://www.ons.gov.uk/methodology/geography/ukgeographies/censusgeography">Middle Super Output Areas</a> are one of the many administrative geographies that the ONS uses for reporting their small area statistics. These codes are used as a quick way of referring to them from official data sources.</td>
</tr>
<tr class="even">
<td align="left"><strong>MSOA.Name</strong></td>
<td align="left">MSOA Name</td>
<td align="left">Name of the MSOA.</td>
</tr>
<tr class="odd">
<td align="left"><strong>LA.Code..2019.boundaries</strong></td>
<td align="left">Local Authority District codes 2019</td>
<td align="left"><a href="https://en.wikipedia.org/wiki/Districts_of_England">Local Authority Districts</a> are a subnational division used for the purposes of local government. Each MSOA belongs to one Local Authority District, however, between years the boundaries of these Local Authority Districts sometimes change. These are the codes of the Local Authority District to which the MSOA belonged to in 2019.</td>
</tr>
<tr class="even">
<td align="left"><strong>LA.name..2019.boundaries</strong></td>
<td align="left">Local Authority District names 2019</td>
<td align="left">Name of the Local Authority District to which the MSOA belonged to in 2019.</td>
</tr>
<tr class="odd">
<td align="left"><strong>LA.Code..2020.boundaries</strong></td>
<td align="left">Local Authority District codes 2020</td>
<td align="left">Code of the Local Authority District to which the MSOA belonged to in 2020</td>
</tr>
<tr class="even">
<td align="left"><strong>LA.name..2020.boundaries</strong></td>
<td align="left">Local Authority District names 2020</td>
<td align="left">Name of the Local Authority District to which the MSOA belonged to in 2019.</td>
</tr>
<tr class="odd">
<td align="left"><strong>All.Ages</strong></td>
<td align="left">Total number of people</td>
<td align="left">The total number of people that is estimated to live in the MSOA mid-2019.</td>
</tr>
</tbody>
</table>
<p>Now we at least have an idea about what our column names mean, we can rename them so that they are a little more intelligible and easier to work with in a later stage.</p>
<div class="sourceCode" id="cb180"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb180-1"><a href="sourcing-data.html#cb180-1" aria-hidden="true"></a><span class="co"># rename columns</span></span>
<span id="cb180-2"><a href="sourcing-data.html#cb180-2" aria-hidden="true"></a><span class="kw">names</span>(midyear) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;msoa_code&#39;</span>,<span class="st">&#39;msoa_name&#39;</span>,<span class="st">&#39;lad19_code&#39;</span>,<span class="st">&#39;lad19_name&#39;</span>,<span class="st">&#39;lad20_code&#39;</span>,<span class="st">&#39;lad20_name&#39;</span>,<span class="st">&#39;pop19&#39;</span>)</span>
<span id="cb180-3"><a href="sourcing-data.html#cb180-3" aria-hidden="true"></a></span>
<span id="cb180-4"><a href="sourcing-data.html#cb180-4" aria-hidden="true"></a><span class="co"># inspect</span></span>
<span id="cb180-5"><a href="sourcing-data.html#cb180-5" aria-hidden="true"></a><span class="kw">names</span>(midyear)</span></code></pre></div>
<pre><code>## [1] &quot;msoa_code&quot;  &quot;msoa_name&quot;  &quot;lad19_code&quot; &quot;lad19_name&quot; &quot;lad20_code&quot;
## [6] &quot;lad20_name&quot; &quot;pop19&quot;</code></pre>
<div class="sourceCode" id="cb182"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb182-1"><a href="sourcing-data.html#cb182-1" aria-hidden="true"></a><span class="co"># write to new csv</span></span>
<span id="cb182-2"><a href="sourcing-data.html#cb182-2" aria-hidden="true"></a><span class="kw">write.csv</span>(midyear, <span class="st">&#39;midyear2019_v2.csv&#39;</span>, <span class="dt">row.names=</span><span class="ot">FALSE</span>)</span></code></pre></div>
<p>Great. This is all looking very good but we are not completely there yet. Now we sourced our data and managed to successfully read the data set into R, we will need to do conduct some final preparations so that our data is analysis ready.</p>
</div>
<div id="recap" class="section level4 unnumbered">
<h4>Recap</h4>
<p>In this section you have learnt how to:</p>
<ol style="list-style-type: decimal">
<li>Download data from the Office for National Statistics.</li>
<li>Select the data that you need and save these into a <code>csv</code> file.</li>
<li>Load the <code>csv</code> file that you created into R.</li>
</ol>
</div>
</div>
<div id="preparing-data" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Preparing data</h2>
<p>Even though the data set that we downloaded came from an official national statistical authority, the data is not directly ready for analysis. In fact, the vast majority of the data you will find in the public domain (or private domain for that matter) will be <strong>dirty data</strong>. With dirty data we mean data that needs some level of pre-processing, cleaning, and linkage before you can use it for your analysis. In the following, you will learn a consistent way to structure your data in R: <strong>tidy data</strong>. Tidy data, as formalised by <a href="http://hadley.nz/">R expert Hadley Wickham</a> in his contribution to the <a href="http://www.jstatsoft.org/v59/i10/paper">Journal of Statistical Software</a> is not only very much at the core of the <code>tidyverse</code> R package that we will introduce you to, but also of general importance when organising your data.</p>
<div id="video-preparing-data" class="section level4 unnumbered">
<h4>Video: Preparing data</h4>
<p><div class="vembedr" align="left">
<div>
<iframe src="https://web.microsoftstream.com/embed/video/98f36fbc-2a25-444f-8291-9aac71acaba5?autoplay=false&amp;showinfo=true" width="533" height="300" style="border:none;"></iframe>
</div>
</div>
<a href="https://liveuclac-my.sharepoint.com/:b:/g/personal/ucfajtv_ucl_ac_uk/ERxtSfPHBY1Em-Cb-EzZItAB_2JxS82zQZqEe5-Syk-fpQ?e=Z2Zoew">[Lecture slides]</a> <a href="https://web.microsoftstream.com/video/98f36fbc-2a25-444f-8291-9aac71acaba5">[Watch on MS stream]</a></p>
<p>As you know by now, your basic R functionality (the <code>base</code> package) can be extended by installing additional packages. These packages are the fundamental units of reproducible R code and include functions, documentation, and sample data. Last week, we introduced you to the <code>ggplot2</code> package: a general scheme for data visualisation that breaks up graphs into semantic components such as scales and layers. Today we will introduce you to the <code>tidyverse</code> package. This package is specifically created to make working with data, including data cleaning and data preparation, easier. Let’s start by installing the <code>tidyverse</code> package using the <code>install_packages()</code> function in the same way as we installed the <code>ggplot2</code> package <a href="examining-data-ii.html#video-installing-packages-in-r">last week</a>.</p>
<div class="sourceCode" id="cb183"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb183-1"><a href="sourcing-data.html#cb183-1" aria-hidden="true"></a><span class="co"># install the tidyverse </span></span>
<span id="cb183-2"><a href="sourcing-data.html#cb183-2" aria-hidden="true"></a><span class="kw">install.packages</span>(<span class="st">&#39;tidyverse&#39;</span>)</span></code></pre></div>
<div class="note">
<p><strong>Note</strong><br/>
The <code>tidyverse</code> package is in fact a <strong>collection of packages</strong> that are specifically designed for data science tasks. Where in many cases different packages work all slightly differently, all packages of the <code>tidyverse</code> share the underlying design philosophy, grammar, and data structures. The <code>ggplot2</code> package that you worked with last week is actually one of the core package of the <code>tidyverse</code>. This also means that if you load the <code>tidyverse</code> package through <code>library(tidyverse)</code> you directly have access to all the functions that are part of the <code>ggplot2</code> package and you do not have to load the <code>ggplot2</code> package seperately. Because the <code>tidyverse</code> consists of multiple packages, it may take a little while before everything is installed so be patient! For more information on <code>tidyverse</code>, have a look at <a href="https://www.tidyverse.org/" class="uri">https://www.tidyverse.org/</a>.</p>
</div>
<p>If your installation was successful, you can now load the <code>tidyverse</code> as follows:</p>
<div class="sourceCode" id="cb184"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb184-1"><a href="sourcing-data.html#cb184-1" aria-hidden="true"></a><span class="co"># load the tidyverse </span></span>
<span id="cb184-2"><a href="sourcing-data.html#cb184-2" aria-hidden="true"></a><span class="kw">library</span>(tidyverse)</span></code></pre></div>
<pre><code>## ── Attaching packages ─────────────────────────────────────────────── tidyverse 1.3.0 ──</code></pre>
<pre><code>## ✓ tibble  3.0.4     ✓ dplyr   1.0.3
## ✓ tidyr   1.1.2     ✓ stringr 1.4.0
## ✓ readr   1.4.0     ✓ forcats 0.5.0
## ✓ purrr   0.3.4</code></pre>
<pre><code>## ── Conflicts ────────────────────────────────────────────────── tidyverse_conflicts() ──
## x dplyr::filter() masks stats::filter()
## x dplyr::lag()    masks stats::lag()</code></pre>
<div class="figure" style="text-align: center"><span id="fig:04-figure-load-tidyverse"></span>
<img src="images/week04/04_load_tidyverse.png" alt="Loading the tidyverse."  />
<p class="caption">
Figure 4.3: Loading the tidyverse.
</p>
</div>
<div class="note">
<p><strong>Note</strong><br/>
After loading the <code>tidyverse</code>, you may get a short information messages to inform you which packages are attached to your R session and whether there are any conflicting functions. This simply means that there are functions that are named the same across the packages that you have loaded. For instance, when you load the <code>tidyverse</code> in a fresh R session, the <code>tidyverse</code> will tell you that two functions from the <code>dplyr</code> package (which is an integral part of the <code>tidyverse</code> package) <em>mask</em> the functionality of two functions of the <code>stats</code> package (which is part of <code>base</code> R). This simply means that if you now type in <code>filter()</code> you will get the <code>dplyr</code> functionality and not the functionality of the <code>stats</code>. This is very important information as both these functions do something <strong>completely</strong> different! You can still use the <code>filter()</code> function from the <code>stats</code> package but then you have to explicitly tell R that you want to use the function called <code>filter()</code> within the stats package: <code>stats::filter()</code>.</p>
</div>
<p>Now that we have loaded the <code>tidyverse</code> we can continue with our data preparation. We will start by reading in the <code>csv</code> file that we created earlier, however, we will use the function <code>read_csv()</code> from the <code>tidyverse</code> instead of the function <code>read.csv()</code> from <code>base</code> R. The function <code>read_csv</code> returns a so-called <code>tibble</code>. <a href="https://r4ds.had.co.nz/tibbles.html">Tibbles</a> are data frames, but they tweak some older behaviours to make life a little easier.</p>
<div class="sourceCode" id="cb188"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb188-1"><a href="sourcing-data.html#cb188-1" aria-hidden="true"></a><span class="co"># load csv file from working directory</span></span>
<span id="cb188-2"><a href="sourcing-data.html#cb188-2" aria-hidden="true"></a>midyear &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&#39;midyear2019_v2.csv&#39;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb189"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb189-1"><a href="sourcing-data.html#cb189-1" aria-hidden="true"></a><span class="co"># inspect</span></span>
<span id="cb189-2"><a href="sourcing-data.html#cb189-2" aria-hidden="true"></a>midyear</span></code></pre></div>
<pre><code>## # A tibble: 7,201 x 7
##    msoa_code msoa_name    lad19_code lad19_name lad20_code lad20_name pop19
##    &lt;chr&gt;     &lt;chr&gt;        &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;
##  1 E02002483 Hartlepool … E06000001  Hartlepool E06000001  Hartlepool 10 2…
##  2 E02002484 Hartlepool … E06000001  Hartlepool E06000001  Hartlepool 10 4…
##  3 E02002485 Hartlepool … E06000001  Hartlepool E06000001  Hartlepool 8 185
##  4 E02002487 Hartlepool … E06000001  Hartlepool E06000001  Hartlepool 5 277
##  5 E02002488 Hartlepool … E06000001  Hartlepool E06000001  Hartlepool 5 848
##  6 E02002489 Hartlepool … E06000001  Hartlepool E06000001  Hartlepool 7 730
##  7 E02002490 Hartlepool … E06000001  Hartlepool E06000001  Hartlepool 6 214
##  8 E02002491 Hartlepool … E06000001  Hartlepool E06000001  Hartlepool 6 454
##  9 E02002492 Hartlepool … E06000001  Hartlepool E06000001  Hartlepool 6 887
## 10 E02002493 Hartlepool … E06000001  Hartlepool E06000001  Hartlepool 6 702
## # … with 7,191 more rows</code></pre>
</div>
<div id="questions-1" class="section level4 unnumbered">
<h4>Questions</h4>
<ol style="list-style-type: decimal">
<li>Do you notice a difference between how <code>base</code> R prints a data frame and how a <code>tibble</code> gets printed?</li>
</ol>
<p>Let’s have a better look at our data particularly the data types. We can can do this through the <code>str()</code> function:</p>
<div class="sourceCode" id="cb191"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb191-1"><a href="sourcing-data.html#cb191-1" aria-hidden="true"></a><span class="co"># inspect</span></span>
<span id="cb191-2"><a href="sourcing-data.html#cb191-2" aria-hidden="true"></a><span class="kw">str</span>(midyear)</span></code></pre></div>
<pre><code>## tibble [7,201 × 7] (S3: spec_tbl_df/tbl_df/tbl/data.frame)
##  $ msoa_code : chr [1:7201] &quot;E02002483&quot; &quot;E02002484&quot; &quot;E02002485&quot; &quot;E02002487&quot; ...
##  $ msoa_name : chr [1:7201] &quot;Hartlepool 001&quot; &quot;Hartlepool 002&quot; &quot;Hartlepool 003&quot; &quot;Hartlepool 005&quot; ...
##  $ lad19_code: chr [1:7201] &quot;E06000001&quot; &quot;E06000001&quot; &quot;E06000001&quot; &quot;E06000001&quot; ...
##  $ lad19_name: chr [1:7201] &quot;Hartlepool&quot; &quot;Hartlepool&quot; &quot;Hartlepool&quot; &quot;Hartlepool&quot; ...
##  $ lad20_code: chr [1:7201] &quot;E06000001&quot; &quot;E06000001&quot; &quot;E06000001&quot; &quot;E06000001&quot; ...
##  $ lad20_name: chr [1:7201] &quot;Hartlepool&quot; &quot;Hartlepool&quot; &quot;Hartlepool&quot; &quot;Hartlepool&quot; ...
##  $ pop19     : chr [1:7201] &quot;10 261&quot; &quot;10 449&quot; &quot;8 185&quot; &quot;5 277&quot; ...
##  - attr(*, &quot;spec&quot;)=
##   .. cols(
##   ..   msoa_code = col_character(),
##   ..   msoa_name = col_character(),
##   ..   lad19_code = col_character(),
##   ..   lad19_name = col_character(),
##   ..   lad20_code = col_character(),
##   ..   lad20_name = col_character(),
##   ..   pop19 = col_character()
##   .. )</code></pre>
<p>The output of the <code>str()</code> function tells us that every column in our data frame (tibble) is of type “character”, which comes down to a variable that contains textual data. What is interesting, obviously, is that also our <em>pop19</em> variable is considered a character variable. The reason for this is that in the original data white space is used as thousands separator (i.e. <code>11 000</code> instead of <code>11000</code> or <code>11,000</code>). Does it matter? Well, let’s try to calculate the mean and median of our <em>pop19</em> variable:</p>
<div class="sourceCode" id="cb193"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb193-1"><a href="sourcing-data.html#cb193-1" aria-hidden="true"></a><span class="co"># mean</span></span>
<span id="cb193-2"><a href="sourcing-data.html#cb193-2" aria-hidden="true"></a><span class="kw">mean</span>(midyear<span class="op">$</span>pop19)</span></code></pre></div>
<pre><code>## Warning in mean.default(midyear$pop19): argument is not numeric or logical:
## returning NA</code></pre>
<pre><code>## [1] NA</code></pre>
<div class="sourceCode" id="cb196"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb196-1"><a href="sourcing-data.html#cb196-1" aria-hidden="true"></a><span class="co"># median</span></span>
<span id="cb196-2"><a href="sourcing-data.html#cb196-2" aria-hidden="true"></a><span class="kw">median</span>(midyear<span class="op">$</span>pop19)</span></code></pre></div>
<pre><code>## [1] &quot;7 251&quot;</code></pre>
<div class="note">
<p><strong>Note</strong><br/>
Depending on computer settings and the version of Microsoft Excel or spreadsheet software that you use, in some case you could get a numeric variable (e.g. double) instead of a character variable for your <em>pop19</em> variable. If so: you are lucky and do not need to undertake the steps below to turn this character column into a numeric column. (This will also mean that at this stage your results will differ from the results shown here.) Just continue with the tutorial by carefully reading through the steps that you would have needed to take if indeed your results would have been the same as shown here.</p>
</div>
<p>As you can see, this is not working perfectly for the simple fact that the the <code>mean()</code> function requires a numeric variable as its input! The <code>median()</code> does return a value, however, this is not per se the median that we are interested in as the sorting of the data is now done alphabetically: see for your self what happens when using the <code>sort()</code> function on the <em>pop19</em> variable. Fortunately, there are some functions in the <code>dplyr</code> package, which is part of the <code>tidyverse</code>, that will help us further cleaning and preparing our data. Some of the most important and useful functions are:</p>
<table>
<thead>
<tr class="header">
<th align="left">Package</th>
<th align="left">Function</th>
<th align="left">Use to</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">dplyr</td>
<td align="left">select</td>
<td align="left">select columns</td>
</tr>
<tr class="even">
<td align="left">dplyr</td>
<td align="left">filter</td>
<td align="left">select rows</td>
</tr>
<tr class="odd">
<td align="left">dplyr</td>
<td align="left">mutate</td>
<td align="left">transform or recode variables</td>
</tr>
<tr class="even">
<td align="left">dplyr</td>
<td align="left">summarise</td>
<td align="left">summarise data</td>
</tr>
<tr class="odd">
<td align="left">dplyr</td>
<td align="left">group by</td>
<td align="left">group data into subgroups for further processing</td>
</tr>
</tbody>
</table>
<div class="note">
<p><strong>Note</strong><br/>
Remember that when you encounter a function in a piece of R code that you have not seen before and you are wondering what it does that you can get access the documentation through <code>?name_of_function</code>, e.g. <code>?mutate</code>. For almost any R package, the documentation contains a list of arguments that the function takes, in which format the functions expects these arguments, as well as a set of usage examples.</p>
</div>
<p>Let’s have a look at two of the <code>dplyr</code> functions: <code>select()</code> and <code>filter()</code>.</p>
<div class="sourceCode" id="cb198"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb198-1"><a href="sourcing-data.html#cb198-1" aria-hidden="true"></a><span class="co"># select columns with the select function</span></span>
<span id="cb198-2"><a href="sourcing-data.html#cb198-2" aria-hidden="true"></a><span class="co"># note that within dplyr we not use quotation marks to refer to columns</span></span>
<span id="cb198-3"><a href="sourcing-data.html#cb198-3" aria-hidden="true"></a>midyear_sel &lt;-<span class="st"> </span><span class="kw">select</span>(midyear,msoa_code,msoa_name,lad20_code,lad20_name,pop19)</span>
<span id="cb198-4"><a href="sourcing-data.html#cb198-4" aria-hidden="true"></a></span>
<span id="cb198-5"><a href="sourcing-data.html#cb198-5" aria-hidden="true"></a><span class="co"># inspect</span></span>
<span id="cb198-6"><a href="sourcing-data.html#cb198-6" aria-hidden="true"></a>midyear_sel</span></code></pre></div>
<pre><code>## # A tibble: 7,201 x 5
##    msoa_code msoa_name      lad20_code lad20_name pop19 
##    &lt;chr&gt;     &lt;chr&gt;          &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt; 
##  1 E02002483 Hartlepool 001 E06000001  Hartlepool 10 261
##  2 E02002484 Hartlepool 002 E06000001  Hartlepool 10 449
##  3 E02002485 Hartlepool 003 E06000001  Hartlepool 8 185 
##  4 E02002487 Hartlepool 005 E06000001  Hartlepool 5 277 
##  5 E02002488 Hartlepool 006 E06000001  Hartlepool 5 848 
##  6 E02002489 Hartlepool 007 E06000001  Hartlepool 7 730 
##  7 E02002490 Hartlepool 008 E06000001  Hartlepool 6 214 
##  8 E02002491 Hartlepool 009 E06000001  Hartlepool 6 454 
##  9 E02002492 Hartlepool 010 E06000001  Hartlepool 6 887 
## 10 E02002493 Hartlepool 011 E06000001  Hartlepool 6 702 
## # … with 7,191 more rows</code></pre>
<div class="sourceCode" id="cb200"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb200-1"><a href="sourcing-data.html#cb200-1" aria-hidden="true"></a><span class="co"># filter rows with the filter function</span></span>
<span id="cb200-2"><a href="sourcing-data.html#cb200-2" aria-hidden="true"></a><span class="co"># note that within dplyr we not use quotation marks to refer to columns</span></span>
<span id="cb200-3"><a href="sourcing-data.html#cb200-3" aria-hidden="true"></a>midyear_fil &lt;-<span class="st"> </span><span class="kw">filter</span>(midyear,lad20_name<span class="op">==</span><span class="st">&#39;Leeds&#39;</span>)</span>
<span id="cb200-4"><a href="sourcing-data.html#cb200-4" aria-hidden="true"></a></span>
<span id="cb200-5"><a href="sourcing-data.html#cb200-5" aria-hidden="true"></a><span class="co"># inspect</span></span>
<span id="cb200-6"><a href="sourcing-data.html#cb200-6" aria-hidden="true"></a>midyear_fil</span></code></pre></div>
<pre><code>## # A tibble: 107 x 7
##    msoa_code msoa_name lad19_code lad19_name lad20_code lad20_name pop19
##    &lt;chr&gt;     &lt;chr&gt;     &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;
##  1 E02002330 Leeds 001 E08000035  Leeds      E08000035  Leeds      6 572
##  2 E02002331 Leeds 002 E08000035  Leeds      E08000035  Leeds      7 029
##  3 E02002332 Leeds 003 E08000035  Leeds      E08000035  Leeds      6 143
##  4 E02002333 Leeds 004 E08000035  Leeds      E08000035  Leeds      7 637
##  5 E02002334 Leeds 005 E08000035  Leeds      E08000035  Leeds      7 110
##  6 E02002335 Leeds 006 E08000035  Leeds      E08000035  Leeds      7 500
##  7 E02002336 Leeds 007 E08000035  Leeds      E08000035  Leeds      6 596
##  8 E02002337 Leeds 008 E08000035  Leeds      E08000035  Leeds      7 388
##  9 E02002338 Leeds 009 E08000035  Leeds      E08000035  Leeds      6 817
## 10 E02002339 Leeds 010 E08000035  Leeds      E08000035  Leeds      5 351
## # … with 97 more rows</code></pre>
</div>
<div id="questions-2" class="section level4 unnumbered">
<h4>Questions</h4>
<ol style="list-style-type: decimal">
<li>How can we get the same data frame with selected columns (<code>midyear_sel</code>) using the <code>base</code> R syntax we have been using in previous weeks?</li>
<li>How can we get the same data frame with filtered rows (<code>midyear_fil</code>) using the <code>base</code> R syntax we have been using in previous weeks?</li>
</ol>
<p>With the <code>mutate()</code> function we can easily create new columns, so let’s try this function to see if we can create a new variable that contains all the data from <em>pop19</em> in a numeric format.</p>
<div class="sourceCode" id="cb202"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb202-1"><a href="sourcing-data.html#cb202-1" aria-hidden="true"></a><span class="co"># create a new variable named pop19_no space</span></span>
<span id="cb202-2"><a href="sourcing-data.html#cb202-2" aria-hidden="true"></a><span class="co"># by replacing all white space with nothing using the &quot;str_replace_all&quot; function</span></span>
<span id="cb202-3"><a href="sourcing-data.html#cb202-3" aria-hidden="true"></a>midyear &lt;-<span class="st"> </span><span class="kw">mutate</span>(midyear, <span class="dt">pop19_nospace=</span><span class="kw">str_replace_all</span>(pop19, <span class="dt">pattern=</span><span class="st">&#39; &#39;</span>, <span class="dt">repl=</span><span class="st">&#39;&#39;</span>))</span>
<span id="cb202-4"><a href="sourcing-data.html#cb202-4" aria-hidden="true"></a></span>
<span id="cb202-5"><a href="sourcing-data.html#cb202-5" aria-hidden="true"></a><span class="co"># inspect</span></span>
<span id="cb202-6"><a href="sourcing-data.html#cb202-6" aria-hidden="true"></a>midyear</span></code></pre></div>
<pre><code>## # A tibble: 7,201 x 8
##    msoa_code msoa_name lad19_code lad19_name lad20_code lad20_name pop19
##    &lt;chr&gt;     &lt;chr&gt;     &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;
##  1 E02002483 Hartlepo… E06000001  Hartlepool E06000001  Hartlepool 10 2…
##  2 E02002484 Hartlepo… E06000001  Hartlepool E06000001  Hartlepool 10 4…
##  3 E02002485 Hartlepo… E06000001  Hartlepool E06000001  Hartlepool 8 185
##  4 E02002487 Hartlepo… E06000001  Hartlepool E06000001  Hartlepool 5 277
##  5 E02002488 Hartlepo… E06000001  Hartlepool E06000001  Hartlepool 5 848
##  6 E02002489 Hartlepo… E06000001  Hartlepool E06000001  Hartlepool 7 730
##  7 E02002490 Hartlepo… E06000001  Hartlepool E06000001  Hartlepool 6 214
##  8 E02002491 Hartlepo… E06000001  Hartlepool E06000001  Hartlepool 6 454
##  9 E02002492 Hartlepo… E06000001  Hartlepool E06000001  Hartlepool 6 887
## 10 E02002493 Hartlepo… E06000001  Hartlepool E06000001  Hartlepool 6 702
## # … with 7,191 more rows, and 1 more variable: pop19_nospace &lt;chr&gt;</code></pre>
<div class="sourceCode" id="cb204"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb204-1"><a href="sourcing-data.html#cb204-1" aria-hidden="true"></a><span class="co"># create a new variable named pop19_numeric</span></span>
<span id="cb204-2"><a href="sourcing-data.html#cb204-2" aria-hidden="true"></a><span class="co"># by transorming the pop19_nospace variable using the &quot;as.numeric&quot; function</span></span>
<span id="cb204-3"><a href="sourcing-data.html#cb204-3" aria-hidden="true"></a>midyear &lt;-<span class="st"> </span><span class="kw">mutate</span>(midyear,<span class="dt">pop19_numeric=</span><span class="kw">as.numeric</span>(pop19_nospace))</span>
<span id="cb204-4"><a href="sourcing-data.html#cb204-4" aria-hidden="true"></a></span>
<span id="cb204-5"><a href="sourcing-data.html#cb204-5" aria-hidden="true"></a><span class="co"># inspect</span></span>
<span id="cb204-6"><a href="sourcing-data.html#cb204-6" aria-hidden="true"></a>midyear</span></code></pre></div>
<pre><code>## # A tibble: 7,201 x 9
##    msoa_code msoa_name lad19_code lad19_name lad20_code lad20_name pop19
##    &lt;chr&gt;     &lt;chr&gt;     &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;
##  1 E02002483 Hartlepo… E06000001  Hartlepool E06000001  Hartlepool 10 2…
##  2 E02002484 Hartlepo… E06000001  Hartlepool E06000001  Hartlepool 10 4…
##  3 E02002485 Hartlepo… E06000001  Hartlepool E06000001  Hartlepool 8 185
##  4 E02002487 Hartlepo… E06000001  Hartlepool E06000001  Hartlepool 5 277
##  5 E02002488 Hartlepo… E06000001  Hartlepool E06000001  Hartlepool 5 848
##  6 E02002489 Hartlepo… E06000001  Hartlepool E06000001  Hartlepool 7 730
##  7 E02002490 Hartlepo… E06000001  Hartlepool E06000001  Hartlepool 6 214
##  8 E02002491 Hartlepo… E06000001  Hartlepool E06000001  Hartlepool 6 454
##  9 E02002492 Hartlepo… E06000001  Hartlepool E06000001  Hartlepool 6 887
## 10 E02002493 Hartlepo… E06000001  Hartlepool E06000001  Hartlepool 6 702
## # … with 7,191 more rows, and 2 more variables: pop19_nospace &lt;chr&gt;,
## #   pop19_numeric &lt;dbl&gt;</code></pre>
<div class="sourceCode" id="cb206"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb206-1"><a href="sourcing-data.html#cb206-1" aria-hidden="true"></a><span class="co"># inspect</span></span>
<span id="cb206-2"><a href="sourcing-data.html#cb206-2" aria-hidden="true"></a><span class="kw">str</span>(midyear)</span></code></pre></div>
<pre><code>## tibble [7,201 × 9] (S3: spec_tbl_df/tbl_df/tbl/data.frame)
##  $ msoa_code    : chr [1:7201] &quot;E02002483&quot; &quot;E02002484&quot; &quot;E02002485&quot; &quot;E02002487&quot; ...
##  $ msoa_name    : chr [1:7201] &quot;Hartlepool 001&quot; &quot;Hartlepool 002&quot; &quot;Hartlepool 003&quot; &quot;Hartlepool 005&quot; ...
##  $ lad19_code   : chr [1:7201] &quot;E06000001&quot; &quot;E06000001&quot; &quot;E06000001&quot; &quot;E06000001&quot; ...
##  $ lad19_name   : chr [1:7201] &quot;Hartlepool&quot; &quot;Hartlepool&quot; &quot;Hartlepool&quot; &quot;Hartlepool&quot; ...
##  $ lad20_code   : chr [1:7201] &quot;E06000001&quot; &quot;E06000001&quot; &quot;E06000001&quot; &quot;E06000001&quot; ...
##  $ lad20_name   : chr [1:7201] &quot;Hartlepool&quot; &quot;Hartlepool&quot; &quot;Hartlepool&quot; &quot;Hartlepool&quot; ...
##  $ pop19        : chr [1:7201] &quot;10 261&quot; &quot;10 449&quot; &quot;8 185&quot; &quot;5 277&quot; ...
##  $ pop19_nospace: chr [1:7201] &quot;10261&quot; &quot;10449&quot; &quot;8185&quot; &quot;5277&quot; ...
##  $ pop19_numeric: num [1:7201] 10261 10449 8185 5277 5848 ...
##  - attr(*, &quot;spec&quot;)=
##   .. cols(
##   ..   msoa_code = col_character(),
##   ..   msoa_name = col_character(),
##   ..   lad19_code = col_character(),
##   ..   lad19_name = col_character(),
##   ..   lad20_code = col_character(),
##   ..   lad20_name = col_character(),
##   ..   pop19 = col_character()
##   .. )</code></pre>
<p>Note the information for <em>pop19_numeric</em>: <code>str</code> indicates that the column is now of type <code>num</code> (i.e. numeric). This is much better. We can now try to calculate the median and the mean again:</p>
<div class="sourceCode" id="cb208"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb208-1"><a href="sourcing-data.html#cb208-1" aria-hidden="true"></a><span class="co"># calculate the mean of the pop19_numeric variable</span></span>
<span id="cb208-2"><a href="sourcing-data.html#cb208-2" aria-hidden="true"></a><span class="kw">mean</span>(midyear<span class="op">$</span>pop19_numeric)</span></code></pre></div>
<pre><code>## [1] 8254.387</code></pre>
<div class="sourceCode" id="cb210"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb210-1"><a href="sourcing-data.html#cb210-1" aria-hidden="true"></a><span class="co"># calculate the median of the pop19_numeric variable</span></span>
<span id="cb210-2"><a href="sourcing-data.html#cb210-2" aria-hidden="true"></a><span class="kw">median</span>(midyear<span class="op">$</span>pop19_numeric)</span></code></pre></div>
<pre><code>## [1] 7955</code></pre>
<p>Everything seems to be working fine now and our data is now finally ready for analysis, so it is probably wise to save’s save it.</p>
<div class="sourceCode" id="cb212"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb212-1"><a href="sourcing-data.html#cb212-1" aria-hidden="true"></a><span class="co"># write to new csv</span></span>
<span id="cb212-2"><a href="sourcing-data.html#cb212-2" aria-hidden="true"></a><span class="kw">write.csv</span>(midyear, <span class="st">&#39;midyear2019_clean.csv&#39;</span>, <span class="dt">row.names=</span><span class="ot">FALSE</span>)</span></code></pre></div>
</div>
<div id="recap-1" class="section level4 unnumbered">
<h4>Recap</h4>
<p>In this section you have learnt how to:</p>
<ol style="list-style-type: decimal">
<li>Transform your data frame to a tibble.</li>
<li>Use some of the functionality of the <code>tidyverse</code> to prepare your data set and make it suitable for analysis.</li>
</ol>
</div>
</div>
<div id="seminar-w04" class="section level2" number="4.4">
<h2><span class="header-section-number">4.4</span> Seminar</h2>
<p>Please find the seminar task and seminar questions for this week’s seminar below.</p>
<div class="note">
<p><strong>Note</strong><br/>
Please make sure that you have executed the seminar task and have answered the seminar questions before the seminar!</p>
</div>
<div id="seminar-task" class="section level4 unnumbered">
<h4>Seminar task</h4>
<p>Of course, we did not go through all the trouble of downloading and preparing this file without using it. Use the cleaned version of the <code>midyear</code> data set that we just created to:</p>
<ol style="list-style-type: decimal">
<li>Create a new object / data set that only contains data for the Local Authority District (2020 boundaries) of <em>Manchester</em>.</li>
<li>Create a new object / data set that only contains data for the Local Authority District (2020 boundaries) of <em>Birmingham</em>.</li>
</ol>
<p>For <strong>both</strong> new objects:</p>
<ol style="list-style-type: decimal">
<li>Calculate the mean, median, and standard deviation of the <em>pop19_numeric</em> variable.</li>
<li>Create a boxplot of the <em>pop19_numeric</em> variable using the <code>ggplot2</code> package.</li>
<li>Create a histogram of the <em>pop19_numeric</em> variable using the <code>ggplot2</code> package. Select a bin width that you think is appropriate.</li>
</ol>
</div>
<div id="seminar-questions" class="section level4 unnumbered">
<h4>Seminar questions</h4>
<ol style="list-style-type: decimal">
<li>Compare the results of the descriptive statistics you have calculated for your <em>Birmingham</em> object / data set with the results of the descriptive statistics you have calculated for you <em>Manchester</em> data set. What do these descriptive statistics tell you?</li>
<li>Why did you select the bin width that you used for creating your histograms?</li>
<li>Compare the histograms that you created for your <em>Birmingham</em> object / data set and the <em>Manchester</em> data set, what can you tell about the population distribution of both Local Authority Districts?</li>
</ol>
</div>
<div id="additional-tasks" class="section level4 unnumbered">
<h4>Additional tasks</h4>
<p>If you found these assignments and questions relatively easy and want an assignment that is a little more realistic, try to do the following:</p>
<ol style="list-style-type: decimal">
<li>Download the mid-year population estimates for 2018 to your computer (<code>Mid-2018: SAPE21DT15 (unformatted)</code>). Make sure that you download the file with exactly this name: it is listed under the “supporting files you may find useful” heading.</li>
<li>Prepare a <code>csv</code> file of the first three columns of the <code>Mid-2018 Perons</code> tab and import into R.</li>
<li>Give the columns the following names: <em>msoa_code</em>, <em>msoa_name</em>, <em>pop18</em>.</li>
<li>Take the necessary steps in R to make sure that all numeric variables are also recognised by R as numeric variables.</li>
<li>Join the 2018 and 2019 midyear population data set by using the <code>left join()</code> function from the <code>tidyverse()</code> package, e.g. something like: <code>midyear &lt;- left_join(midyear2018, midyear2019, by=c('msoa_code'='msoa_code')</code>.</li>
<li>Calculate the population change between 2018 and 2019.</li>
<li>Create a histogram of the population change.</li>
<li>Which MSOA has the largest decline in population between 2018 and 2019? Which MSOA had the largest increase in population between 2018 and 2019?</li>
</ol>
</div>
<div id="seminar-link" class="section level4 unnumbered">
<h4>Seminar link</h4>
<p>Seminars for all groups take place on <strong>Thursday morning</strong>. You can find the <strong>Zoom</strong> link to your seminar group on <a href="https://moodle.ucl.ac.uk/course/view.php?id=6845">Moodle</a>.</p>
</div>
</div>
<div id="byl-w04" class="section level2" number="4.5">
<h2><span class="header-section-number">4.5</span> Before you leave</h2>
<p>Save your R script by pressing the <strong>Save</strong> button in the script window. <a href="https://www.youtube.com/watch?v=3wxyN3z9PL4">That is it for this week</a>!</p>

</div>
</div>







            </section>

          </div>
        </div>
      </div>
<a href="examining-data-ii.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/jtvandijk/POLS0008/edit/master/04-week04.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["https://github.com/jtvandijk/POLS0008/raw/master/04-week04.Rmd"],
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
